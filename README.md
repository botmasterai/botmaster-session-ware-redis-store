## Botmaster Session Ware Redis Store

[![Build Status](https://travis-ci.org/botmasterai/botmaster-watson-conversation-ware.svg?branch=master)](https://travis-ci.org/botmasterai/botmaster-watson-conversation-ware)
[![Coverage Status](https://coveralls.io/repos/github/botmasterai/botmaster-watson-conversation-ware/badge.svg?branch=master)](https://coveralls.io/github/botmasterai/botmaster-watson-conversation-ware?branch=master)
[![npm-version](https://img.shields.io/npm/v/botmaster-watson-conversation-ware.svg)](https://www.npmjs.com/package/botmaster-watson-conversation-ware)
[![license](https://img.shields.io/github/license/mashape/apistatus.svg?maxAge=2592000)](LICENSE)

This is the Redis store adapter for the botmaster-session-ware middleware. Using is 

## Install

    yarn add botmaster-session-ware-redis-store

or with npm

    npm install --save botmaster-session-ware-redis-store

## Note

This package is an adapter for botmaster-session-ware:
<https://github.com/botmasterai/botmaster-session-ware>

# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## RedisStore

Using this adapter along with the botmaster-session-ware middleware will
store sessions in redis rather than use the default in memory store which
should not be used in production

**Parameters**

-   `redisSettings`  
-   `settings` **[object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** just a valid ioredis settings object as per:
    <https://github.com/luin/ioredis> which is used under the hood. By default,
    will connect to 127.0.0.1:6379
    \*

**Examples**

```javascript
const Botmaster = require('botmaster');
// Using this socket.io bot class for the sake of the example
const SocketioBot = require('botmaster-socket.io');
const SessionWare = require('botmaster-session-ware');
const SessionWareRedisStore = require('botmaster-session-ware-redis-store);

const botmaster = new Botmaster();
botmaster.addBot(new SocketioBot({
  id: 'botId',
  server: botmaster.server,
}));

// declaring middleware

botmaster.use({
  type: 'incoming',
  name: 'my-awesome-middleware',
  controller: async (bot, update) => {
    // this will be {} on the first call from a certain user
    // and will contain the last message upon all the next iterations
    console.log(update.session);

    update.session.lastMessage = update.message;
  }
})

// This will make our context persist throughout different messages from the
// same user
const sessionWare = new SessionWare({ adapter: new RedisStore() });
botmaster.useWrapped(sessionWare.incoming, sessionWare.outgoing);
```

### get

Get or create a session with the id.

**Parameters**

-   `id` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** a unique id for the session

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** evaluates to an object that is the  session

### set

Update a session in the storage.

**Parameters**

-   `id` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** a unique id for the session
-   `value` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** the new value for the session

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** resolves when the session has been saved
